<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Infinite - 我的猿问列表</title>
    <meta name="description" content="Admin, Dashboard, Bootstrap, Bootstrap 4, Angular, AngularJS" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="stylesheet" type="text/css" href="/temp2/assets/styles/app.css" /><!--模板二的样式 -->

    <!-- 插件 css-->
    <link rel="stylesheet" type="text/css" href="/temp1/plugins/bootstrap-tagsinput/css/bootstrap-tagsinput.css" />
    <link rel="stylesheet" type="text/css" href="/temp1/plugins/bootstrap-select/css/bootstrap-select.min.css" />
    <link rel="stylesheet" type="text/css" href="/temp1/plugins/bootstrap-touchspin/css/jquery.bootstrap-touchspin.min.css" />
    <link rel="stylesheet" type="text/css" href="/temp1/plugins/multiselect/css/multi-select.css" />
    <link rel="stylesheet" type="text/css" href="/temp1/plugins/select2/css/select2.min.css" />

    <!-- App css -->
    <link rel="stylesheet" type="text/css" href="/temp1/assets/css/bootstrap.min.css"/><!-- bootstrap -->
    <link rel="stylesheet" type="text/css" href="/temp1/assets/css/core.css" />
    <link rel="stylesheet" type="text/css" href="/temp1/assets/css/components.css" /><!--图标样式 -->
    <link rel="stylesheet" type="text/css" href="/temp1/assets/css/icons.css" />
    <link rel="stylesheet" type="text/css" href="/temp1/assets/css/pages.css" />
    <link rel="stylesheet" type="text/css" href="/temp1/assets/css/menu.css" />
    <link rel="stylesheet" type="text/css" href="/temp1/assets/css/responsive.css" />
    <link rel="stylesheet" type="text/css" href="/temp1/plugins/switchery/switchery.min.css "><!--复选框样式 -->

    <link rel="import" href="/common/depjs.html" />
    <link rel="import" href="/common/depcss.html" />
    <link rel="import" href="/common/form-js.html" />
</head>
<body>
<div class="row-col">
    <div class="col-sm w w-auto-xs light lt bg-auto">
        <div class="padding pos-rlt">
            <button class="btn btn-outline btn-primary btn-block"
                    onclick="addAsk()">提问题</button>
            <div class="hidden-xs-down m-t" id="inbox-menu">
                <div class="nav-active-primary">
                    <div class="nav nav-pills nav-sm flex-column">

                    </div>
                </div>
                <div class="m-y">Labels</div>
                <div class="nav-active-white">
                    <ul class="nav nav-pills nav-stacked nav-sm">
                        <li class="nav-item"><a class="nav-link"> <i
                                class="fa m-r-sm fa-circle text-primary"></i> Angular
                        </a> <a class="nav-link"> <i
                                class="fa m-r-sm fa-circle text-info"></i> Bootstrap
                        </a> <a class="nav-link"> <i
                                class="fa m-r-sm fa-circle text-warn"></i> Client
                        </a> <a class="nav-link"> <i
                                class="fa m-r-sm fa-circle text-accent"></i> Work
                        </a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm">
        <div ui-view class="padding pos-rlt">
            <a href="#" class="md-btn md-fab md-fab-bottom-right pos-fix red" onclick="addAtc()">
                <i class="glyphicon glyphicon-pencil"></i>
            </a>
            <div>
                <!-- header -->
                <div class="m-b">
                    <div class="btn-toolbar">
                        <input id="searchFilter" type="text" class="form-control" placeholder="Say something">
                    </div>
                </div>
                <!-- / header -->
                <!-- list -->
                <div class="list white">
                    <div id="atcListDiv"></div>
                </div>
                <!-- / list -->
            </div>

        </div>
    </div>
</div>

<!-- 文章展示model -->
<div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
    <div class="modal-dialog modal-full">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title" id="modalLabel">文章</h4>
            </div>
            <div class="modal-body" id="_modalDialog_body">
                <iframe id="atcView" src="/infinite/atcView.html" frameBorder="0" width="99.6%"></iframe>
                <a href="#" class="md-btn md-fab md-fab-bottom-right pos-fix red" onclick="edit()">
                    <i class="glyphicon glyphicon-pencil"></i>
                </a>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>
</body>
<script type="text/javascript">
    /*全局变量区*/
    var min_height = document.documentElement.clientHeight - 200;//获取屏幕高度-头部高度
    var AuthorId = 1;
    var Status = 1;//1-所有 2-已发布 3-未发布

    var AtcList = [];//所有的
    var PublishList = [];//已发布的
    var UnPublishList = [];//未发布的
    /*初始化*/
    $(function(){
        initAtcList();
        $('#atcView').attr('height',min_height+"px");
    });

    /*监听区*/
    //监听搜索框的回车
    $('#searchFilter').bind('keypress',function(e){
        if(e.keyCode == 13)
            searchByTitle();
    });
    $("#searchFilter").bind("input propertychange",function(){
        searchByTitle();
    })

    /*方法区*/
    function addAsk(){
        window.parent.getUrl("/infinite/newAsk.html");
    }

    function edit(){
        window.parent.getUrl("/infinite/newAsk.html");
    }

    /***数据获取***/
//获取所有文章列表，并初始化全局变量
    function initAtcList(){
        var url = Const.Api_URL + "/MyAtcController/getMyAtcList";
        var param = {
            authorId : AuthorId,
            status : 1,
            search : "",
            lable : ""
        };
        View.post(url,param,function(resp){
            AtcList = resp;
            reload_AtcListTmpl(resp);
        },function(){

        });
    }

    //全局变量搜索:标题搜索
    function searchByTitle(){
        var titleSearch = $("#searchFilter").val();
        if(titleSearch == ""){
            reload_AtcListTmpl(AtcList);
            return;
        }
        var searchList=[];
        for(var i=0;i<AtcList.length;i++){
            if(AtcList[i].titleInfo.indexOf(titleSearch)!=-1){
                searchList.push(AtcList[i]);
            }
        }
        reload_AtcListTmpl(searchList);
    }

    //通过id获取文章信息
    function getInfoById(id){
        for(var i=0;i<AtcList.length;i++){
            if(AtcList[i].id==id){
                return AtcList[i];
            }
        }
    }

    /***页面渲染***/
//渲染文章列表模板
    function reload_AtcListTmpl(list){
        var data = {};
        data.list = list;
        var temp = new Tmpl("atcListTmpl",data);
        temp.reset("atcListDiv");
    }
</script>
<script id="atcListTmpl" type="text/html">
    {{each list}}
    <div class="list-item b-l b-l-2x b-info">
        <div class="list-left">
		<span class="w-40 avatar"> <img src="/temp2/assets/images/a0.jpg">
		</span>
        </div>
        <div class="list-body">
            <div class="pull-right text-muted text-xs">
                <span class="hidden-xs">5, July</span> <i
                    class="fa fa-paperclip m-l-sm"></i>
            </div>
            <div>
                <a href class="_500" data-toggle="modal" data-target="#myModal">{{$value.titleInfo}}</a>
                <span class="label label-xs m-l-sm text-u-c">Bootstrap</span>
            </div>
            <div class="text-ellipsis text-muted text-sm">描述</div>
        </div>
    </div>
    {{/each}}
</script>
</html>
